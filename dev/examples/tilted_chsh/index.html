<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Tilted CHSH inequality · Ket.jl</title><meta name="title" content="Tilted CHSH inequality · Ket.jl"/><meta property="og:title" content="Tilted CHSH inequality · Ket.jl"/><meta property="twitter:title" content="Tilted CHSH inequality · Ket.jl"/><meta name="description" content="Documentation for Ket.jl."/><meta property="og:description" content="Documentation for Ket.jl."/><meta property="twitter:description" content="Documentation for Ket.jl."/><meta property="og:url" content="https://dev-ket.github.io/Ket.jl/examples/tilted_chsh/"/><meta property="twitter:url" content="https://dev-ket.github.io/Ket.jl/examples/tilted_chsh/"/><link rel="canonical" href="https://dev-ket.github.io/Ket.jl/examples/tilted_chsh/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img class="docs-light-only" src="../../assets/logo.svg" alt="Ket.jl logo"/><img class="docs-dark-only" src="../../assets/logo-dark.svg" alt="Ket.jl logo"/></a><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../getting_started/">Getting started</a></li><li><span class="tocitem">Examples</span><ul><li class="is-active"><a class="tocitem" href>Tilted CHSH inequality</a></li></ul></li><li><a class="tocitem" href="../../api/">List of functions</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Tilted CHSH inequality</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Tilted CHSH inequality</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/dev-ket/Ket.jl/blob/master/docs/src/examples/tilted_chsh.jl#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Tilted-CHSH-inequality"><a class="docs-heading-anchor" href="#Tilted-CHSH-inequality">Tilted CHSH inequality</a><a id="Tilted-CHSH-inequality-1"></a><a class="docs-heading-anchor-permalink" href="#Tilted-CHSH-inequality" title="Permalink"></a></h1><p>Given a Bell expression we often want to compute its local bound and the maximum quantum violation. In Ket this can easily be done using the functions <a href="../../api/#Ket.local_bound"><code>local_bound</code></a>, <a href="../../api/#Ket.seesaw"><code>seesaw</code></a> and <a href="../../api/#Ket.tsirelson_bound"><code>tsirelson_bound</code></a>.</p><p>We will use the tilted CHSH inequality as an example (see <a href="https://journals.aps.org/prl/abstract/10.1103/PhysRevLett.108.100402">Acín et al.’s “Randomness versus nonlocality and entanglement”</a>):</p><p class="math-container">\[\alpha \langle A_0 \rangle + \langle A_0 B_0 \rangle + \langle A_0 B_1 \rangle + \langle A_1 B_0 \rangle - \langle A_1 B_1 \rangle \overset{C}\leqslant 2+\alpha \overset{Q}\leqslant \sqrt{8+2\alpha^2}\]</p><p>In this expression, the <span>$C$</span> bound is the local bound (that is, achievable with classical systems), and the <span>$Q$</span> bound is the analytical solution for the maximum violation using quantum systems. (Of course, in general we do not know the quantum bounds for an arbitrary inequality, this example is so we can compare the results we will obtain via optimization.)</p><p>Let us first define the Bell expression in the full probability representation:</p><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>You can convert between behavior representations using the functions <a href="../../api/#Ket.tensor_probability"><code>tensor_probability</code></a>, <a href="../../api/#Ket.tensor_collinsgisin"><code>tensor_collinsgisin</code></a> and <a href="../../api/#Ket.tensor_correlation"><code>tensor_correlation</code></a>. They also accept a state and a set of measurements as inputs, returning the corresponding behavior.</p></div></div><pre><code class="language-julia hljs">function tilted_chsh(α)
    # in correlation notation, the tilted CHSH is:
    corr = [0  α  0;
            0  1  1;
            0  1 -1]
    return tensor_probability(corr)
end</code></pre><p>Computing the lower bound amounts to finding the maximum of the expression over all deterministic strategies. This can be done using the <a href="../../api/#Ket.local_bound"><code>local_bound</code></a> function, which can be called on any expression written in correlation or full probability format.</p><pre><code class="language-julia hljs">using Ket

# we take 10 different values of α
α = LinRange(0, 1, 10)
# the `.` operator applies the function to each element of the vector
local_bounds = local_bound.(tilted_chsh.(α))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">10-element Vector{Float64}:
 2.0
 2.1111111111111107
 2.2222222222222223
 2.333333333333334
 2.4444444444444446
 2.5555555555555554
 2.666666666666666
 2.7777777777777777
 2.8888888888888893
 3.0</code></pre><p>For the quantum value, we can:</p><ol><li><p>Obtain lower bounds (with a quantum realization in a given dimension) using the <a href="../../api/#Ket.seesaw"><code>seesaw</code></a> function,  whose inputs are an inequality in the Collins-Gisin representation, a vector specifying the scenario, and the dimension.  Since the seesaw algorithm can get trapped in local maxima, it is recommended to run it multiple times and select the best shot.  This is automated via the optional last argument <code>n_shots</code>.</p></li><li><p>Obtain upper bounds using the <a href="../../api/#Ket.tsirelson_bound"><code>tsirelson_bound</code></a> function, which is based on the NPA hierarchy.  It takes an inequality in the Collins-Gisin or full probability representation, a vector specifying the scenario  (the number of outcomes and inputs per party), and the level of the NPA hierarchy.</p></li></ol><pre><code class="language-julia hljs">tilted_chsh_cg(α) = tensor_collinsgisin(tilted_chsh(α))

# the first output of seesaw is the bound
quantum_lbounds = [seesaw(tilted_chsh_cg(αi), (2, 2, 2, 2), 2, 100)[1] for αi in α]

quantum_ubounds_l1 = [tsirelson_bound(tilted_chsh_cg(αi), (2, 2, 2, 2), 1)[1] for αi in α]
quantum_ubounds_l2 = [tsirelson_bound(tilted_chsh_cg(αi), (2, 2, 2, 2), 2)[1] for αi in α]</code></pre><p>To visualize the bounds, we can plot the results and compare them to the analytical solutions:</p><pre><code class="language-julia hljs">using Plots

xs = LinRange(0, 1, 100)

plt = plot(xs, (x -&gt; 2 + x).(xs), label = &quot;Local bound (analytical)&quot;, linewidth = 2.5)
scatter!(α, local_bounds, label = &quot;Local bound (numerical)&quot;, markersize = 5, markershape = :circle)

plot!(xs, (x -&gt; sqrt(8 + 2x^2)).(xs), label = &quot;Quantum bound (analytical)&quot;, linewidth = 2.5)
scatter!(α, quantum_lbounds, label = &quot;Quantum bound (seesaw)&quot;, markersize = 4, markershape = :square)
scatter!(α, quantum_ubounds_l1, label = &quot;Quantum bound (NPA 1)&quot;, markersize = 5, markershape = :diamond)
scatter!(α, quantum_ubounds_l2, label = &quot;Quantum bound (NPA 2)&quot;, markersize = 4, markershape = :utriangle)
plot!(xlabel = &quot;α&quot;, title = &quot;α⟨A₀⟩ + CHSH&quot;)</code></pre><img src="a7676008.svg" alt="Example block output"/><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../getting_started/">« Getting started</a><a class="docs-footer-nextpage" href="../../api/">List of functions »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Wednesday 26 February 2025 10:18">Wednesday 26 February 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
